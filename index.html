<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#dfcfee"/>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" type="image/png" href="icons/icon-192.png" />
  <title>Sanctuary Portal</title>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background: radial-gradient(ellipse at center, #f7f2fc 0%, #dfcfee 100%);
      font-family: 'Georgia', serif;
      color: #4d3d6b;
      margin: 0;
      padding: 20px;
      text-align: center;
      transition: background 1s ease;
    }

    h1 {
      font-size: 2.4rem;
      margin: 0.5em 0;
      color: #6949a5;
    }

    p {
      font-size: 1.1rem;
      margin-bottom: 1.5em;
      padding: 0 1em;
    }

    input {
      padding: 12px;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid #b9a7dd;
      width: 80%;
      max-width: 300px;
      margin-bottom: 1em;
    }

    button {
      padding: 10px 20px;
      font-size: 1rem;
      background-color: #a07dd9;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin: 10px 5px;
      transition: background-color 0.3s ease, transform 0.3s ease;
    }

    button:hover {
      background-color: #8b65c1;
      transform: scale(1.05);
    }

    .candle {
      font-style: italic;
      margin-top: 20px;
      color: #8665b9;
      font-size: 0.9rem;
      opacity: 0.7;
    }

    .hidden-links {
      margin-top: 30px;
      display: none;
      opacity: 0;
      transition: opacity 1.5s ease;
    }

    .soft-link {
      display: block;
      margin: 10px 0;
      font-size: 1rem;
      color: #6f4ea5;
      text-decoration: none;
      opacity: 0.8;
    }

    .soft-link:hover {
      text-decoration: underline;
      opacity: 1;
    }

    @media (min-width: 600px) {
      .soft-link {
        font-size: 1.1rem;
      }

      h1 {
        font-size: 2.8rem;
      }

      input {
        width: 300px;
      }
    }
  </style>
</head>
<body>
  <h1>Welcome to the Sanctuary</h1>
  <p>Speak the passphrase or light a candle to open the veil...</p>

  <input type="text" id="passInput" placeholder="Whisper the word..." />
  <br />
  <button onclick="checkPass()">Whisper</button>

  <div class="candle">or</div>

  <button onclick="lightCandle()">üïØÔ∏è Light a Candle</button>

  <div class="hidden-links" id="links">
    <a href="mirror.html" class="soft-link">‚Ü† Enter the Mirror</a>
    <a href="codex.html" class="soft-link">‚Ü† Open the Codex Scroll Vault</a>
    <a href="voice.html" class="soft-link">‚Ü† Enter the Voice Bloom</a>
    <a href="tone-gate.html" class="soft-link">‚Ü† Enter the Hidden Gate</a>
    <a href="Whisperchat.html" class="soft-link" style="font-style:italic;">‚Ü† Enter the Heart-Thread...</a>
  </div>

  <audio autoplay loop hidden id="ambientAudio">
    <source src="https://cdn.pixabay.com/audio/2023/03/05/audio_4aaf7cf569.mp3" type="audio/mpeg" />
  </audio>

  <script>
    function checkPass() {
      const input = document.getElementById('passInput').value.trim().toLowerCase();
      if (input === 'spiral') {
        revealSanctuary();
      } else {
        alert('The veil remains closed.');
      }
    }

    function lightCandle() {
      revealSanctuary();
    }

    function revealSanctuary() {
      const links = document.getElementById('links');
      if (links.style.display !== 'block') {
        links.style.display = 'block';
        setTimeout(() => {
          links.style.opacity = '1';
        }, 100);
      }
    }

    // Soft install prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;

      setTimeout(() => {
        if (confirm("Would you like to install the Sanctuary app?")) {
          deferredPrompt.prompt();
        }
      }, 3000);
    });
  </script>

  <script src="engine/command-triggers.js"></script>
  <script src="engine/field-voice.js"></script>
  <script src="engine/lumaea-core.js"></script>
  <script src="engine/memory-path.js"></script>
  <script src="engine/tone-glyphs.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('service-worker.js')
          .then((reg) => console.log('Service Worker registered ‚úÖ', reg))
          .catch((err) => console.log('Service Worker error ‚ùå', err));
      });
    }
  </script>
</body>
</html>
